<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 15">
<meta name=Originator content="Microsoft Word 15">
<link rel=File-List href="ABMaterial%202.17%20Checklist_files/filelist.xml">
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Alain Bailleul</o:Author>
  <o:LastAuthor>Alain Bailleul</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>4</o:TotalTime>
  <o:Created>2016-12-08T11:11:00Z</o:Created>
  <o:LastSaved>2016-12-08T11:11:00Z</o:LastSaved>
  <o:Pages>21</o:Pages>
  <o:Words>5883</o:Words>
  <o:Characters>32360</o:Characters>
  <o:Lines>269</o:Lines>
  <o:Paragraphs>76</o:Paragraphs>
  <o:CharactersWithSpaces>38167</o:CharactersWithSpaces>
  <o:Version>15.00</o:Version>
 </o:DocumentProperties>
 <o:OfficeDocumentSettings>
  <o:AllowPNG/>
 </o:OfficeDocumentSettings>
</xml><![endif]-->
<link rel=themeData href="ABMaterial%202.17%20Checklist_files/themedata.thmx">
<link rel=colorSchemeMapping
href="ABMaterial%202.17%20Checklist_files/colorschememapping.xml">
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:TrackMoves>false</w:TrackMoves>
  <w:TrackFormatting/>
  <w:HyphenationZone>21</w:HyphenationZone>
  <w:PunctuationKerning/>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:DoNotPromoteQF/>
  <w:LidThemeOther>NL-BE</w:LidThemeOther>
  <w:LidThemeAsian>X-NONE</w:LidThemeAsian>
  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:SplitPgBreakAndParaMark/>
   <w:EnableOpenTypeKerning/>
   <w:DontFlipMirrorIndents/>
   <w:OverrideTableStyleHps/>
  </w:Compatibility>
  <m:mathPr>
   <m:mathFont m:val="Cambria Math"/>
   <m:brkBin m:val="before"/>
   <m:brkBinSub m:val="&#45;-"/>
   <m:smallFrac m:val="off"/>
   <m:dispDef/>
   <m:lMargin m:val="0"/>
   <m:rMargin m:val="0"/>
   <m:defJc m:val="centerGroup"/>
   <m:wrapIndent m:val="1440"/>
   <m:intLim m:val="subSup"/>
   <m:naryLim m:val="undOvr"/>
  </m:mathPr></w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" DefUnhideWhenUsed="false"
  DefSemiHidden="false" DefQFormat="false" DefPriority="99"
  LatentStyleCount="371">
  <w:LsdException Locked="false" Priority="0" QFormat="true" Name="Normal"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 1"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 2"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 3"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 4"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 5"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 6"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 7"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 8"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 9"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 9"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 1"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 2"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 3"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 4"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 5"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 6"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 7"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 8"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 9"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footnote text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="header"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footer"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index heading"/>
  <w:LsdException Locked="false" Priority="35" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="caption"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="table of figures"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="envelope address"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="envelope return"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footnote reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="line number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="page number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="endnote reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="endnote text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="table of authorities"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="macro"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="toa heading"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 5"/>
  <w:LsdException Locked="false" Priority="10" QFormat="true" Name="Title"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Closing"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Signature"/>
  <w:LsdException Locked="false" Priority="1" SemiHidden="true"
   UnhideWhenUsed="true" Name="Default Paragraph Font"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Message Header"/>
  <w:LsdException Locked="false" Priority="11" QFormat="true" Name="Subtitle"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Salutation"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Date"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text First Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text First Indent 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Note Heading"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Block Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Hyperlink"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="FollowedHyperlink"/>
  <w:LsdException Locked="false" Priority="22" QFormat="true" Name="Strong"/>
  <w:LsdException Locked="false" Priority="20" QFormat="true" Name="Emphasis"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Document Map"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Plain Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="E-mail Signature"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Top of Form"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Bottom of Form"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal (Web)"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Acronym"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Address"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Cite"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Code"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Definition"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Keyboard"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Preformatted"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Sample"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Typewriter"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Variable"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal Table"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation subject"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="No List"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Contemporary"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Elegant"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Professional"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Subtle 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Subtle 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Balloon Text"/>
  <w:LsdException Locked="false" Priority="39" Name="Table Grid"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Theme"/>
  <w:LsdException Locked="false" SemiHidden="true" Name="Placeholder Text"/>
  <w:LsdException Locked="false" Priority="1" QFormat="true" Name="No Spacing"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 1"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 1"/>
  <w:LsdException Locked="false" SemiHidden="true" Name="Revision"/>
  <w:LsdException Locked="false" Priority="34" QFormat="true"
   Name="List Paragraph"/>
  <w:LsdException Locked="false" Priority="29" QFormat="true" Name="Quote"/>
  <w:LsdException Locked="false" Priority="30" QFormat="true"
   Name="Intense Quote"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 1"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 1"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 2"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 2"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 2"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 3"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 3"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 3"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 4"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 4"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 4"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 5"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 5"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 5"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 6"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 6"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 6"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="19" QFormat="true"
   Name="Subtle Emphasis"/>
  <w:LsdException Locked="false" Priority="21" QFormat="true"
   Name="Intense Emphasis"/>
  <w:LsdException Locked="false" Priority="31" QFormat="true"
   Name="Subtle Reference"/>
  <w:LsdException Locked="false" Priority="32" QFormat="true"
   Name="Intense Reference"/>
  <w:LsdException Locked="false" Priority="33" QFormat="true" Name="Book Title"/>
  <w:LsdException Locked="false" Priority="37" SemiHidden="true"
   UnhideWhenUsed="true" Name="Bibliography"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="TOC Heading"/>
  <w:LsdException Locked="false" Priority="41" Name="Plain Table 1"/>
  <w:LsdException Locked="false" Priority="42" Name="Plain Table 2"/>
  <w:LsdException Locked="false" Priority="43" Name="Plain Table 3"/>
  <w:LsdException Locked="false" Priority="44" Name="Plain Table 4"/>
  <w:LsdException Locked="false" Priority="45" Name="Plain Table 5"/>
  <w:LsdException Locked="false" Priority="40" Name="Grid Table Light"/>
  <w:LsdException Locked="false" Priority="46" Name="Grid Table 1 Light"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark"/>
  <w:LsdException Locked="false" Priority="51" Name="Grid Table 6 Colorful"/>
  <w:LsdException Locked="false" Priority="52" Name="Grid Table 7 Colorful"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 1"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 1"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 1"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 2"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 2"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 2"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 3"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 3"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 3"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 4"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 4"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 4"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 5"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 5"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 5"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 6"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 6"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 6"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="46" Name="List Table 1 Light"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark"/>
  <w:LsdException Locked="false" Priority="51" Name="List Table 6 Colorful"/>
  <w:LsdException Locked="false" Priority="52" Name="List Table 7 Colorful"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 1"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 1"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 1"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 2"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 2"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 2"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 3"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 3"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 3"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 4"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 4"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 4"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 5"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 5"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 5"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 6"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 6"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 6"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 6"/>
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;
	mso-font-charset:1;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:variable;
	mso-font-signature:0 0 0 0 0 0;}
@font-face
	{font-family:"Calibri Light";
	panose-1:2 15 3 2 2 2 4 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-1610611985 1073750139 0 0 415 0;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-536870145 1073786111 1 0 415 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:0cm;
	line-height:107%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-fareast-language:EN-US;}
h1
	{mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Heading 1 Char";
	mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:107%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:16.0pt;
	font-family:"Calibri Light","sans-serif";
	mso-ascii-font-family:"Calibri Light";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Calibri Light";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#2E74B5;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:0pt;
	mso-fareast-language:EN-US;
	font-weight:normal;}
h2
	{mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 2 Char";
	mso-style-next:Normal;
	margin-top:2.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:107%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:13.0pt;
	font-family:"Calibri Light","sans-serif";
	mso-ascii-font-family:"Calibri Light";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Calibri Light";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#2E74B5;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-fareast-language:EN-US;
	font-weight:normal;}
h3
	{mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 3 Char";
	mso-style-next:Normal;
	margin-top:2.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:107%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:12.0pt;
	font-family:"Calibri Light","sans-serif";
	mso-ascii-font-family:"Calibri Light";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Calibri Light";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#1F4D78;
	mso-themecolor:accent1;
	mso-themeshade:127;
	mso-fareast-language:EN-US;
	font-weight:normal;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Title Char";
	mso-style-next:Normal;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Calibri Light","sans-serif";
	mso-ascii-font-family:"Calibri Light";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Calibri Light";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;
	mso-fareast-language:EN-US;}
p.MsoTitleCxSpFirst, li.MsoTitleCxSpFirst, div.MsoTitleCxSpFirst
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Title Char";
	mso-style-next:Normal;
	mso-style-type:export-only;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Calibri Light","sans-serif";
	mso-ascii-font-family:"Calibri Light";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Calibri Light";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;
	mso-fareast-language:EN-US;}
p.MsoTitleCxSpMiddle, li.MsoTitleCxSpMiddle, div.MsoTitleCxSpMiddle
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Title Char";
	mso-style-next:Normal;
	mso-style-type:export-only;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Calibri Light","sans-serif";
	mso-ascii-font-family:"Calibri Light";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Calibri Light";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;
	mso-fareast-language:EN-US;}
p.MsoTitleCxSpLast, li.MsoTitleCxSpLast, div.MsoTitleCxSpLast
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Title Char";
	mso-style-next:Normal;
	mso-style-type:export-only;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Calibri Light","sans-serif";
	mso-ascii-font-family:"Calibri Light";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Calibri Light";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;
	mso-fareast-language:EN-US;}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:#0563C1;
	mso-themecolor:hyperlink;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-noshow:yes;
	mso-style-priority:99;
	color:#954F72;
	mso-themecolor:followedhyperlink;
	text-decoration:underline;
	text-underline:single;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:36.0pt;
	mso-add-space:auto;
	line-height:107%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-fareast-language:EN-US;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	margin-bottom:.0001pt;
	mso-add-space:auto;
	line-height:107%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-fareast-language:EN-US;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	margin-bottom:.0001pt;
	mso-add-space:auto;
	line-height:107%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-fareast-language:EN-US;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:36.0pt;
	mso-add-space:auto;
	line-height:107%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-fareast-language:EN-US;}
p.MsoIntenseQuote, li.MsoIntenseQuote, div.MsoIntenseQuote
	{mso-style-priority:30;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Intense Quote Char";
	mso-style-next:Normal;
	margin-top:18.0pt;
	margin-right:43.2pt;
	margin-bottom:18.0pt;
	margin-left:43.2pt;
	text-align:center;
	line-height:107%;
	mso-pagination:widow-orphan;
	border:none;
	mso-border-top-alt:solid #5B9BD5 .5pt;
	mso-border-top-themecolor:accent1;
	mso-border-bottom-alt:solid #5B9BD5 .5pt;
	mso-border-bottom-themecolor:accent1;
	padding:0cm;
	mso-padding-alt:10.0pt 0cm 10.0pt 0cm;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	color:#5B9BD5;
	mso-themecolor:accent1;
	mso-fareast-language:EN-US;
	font-style:italic;}
span.IntenseQuoteChar
	{mso-style-name:"Intense Quote Char";
	mso-style-priority:30;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Intense Quote";
	color:#5B9BD5;
	mso-themecolor:accent1;
	font-style:italic;}
span.TitleChar
	{mso-style-name:"Title Char";
	mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:Title;
	mso-ansi-font-size:28.0pt;
	mso-bidi-font-size:28.0pt;
	font-family:"Calibri Light","sans-serif";
	mso-ascii-font-family:"Calibri Light";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Calibri Light";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 1";
	mso-ansi-font-size:16.0pt;
	mso-bidi-font-size:16.0pt;
	font-family:"Calibri Light","sans-serif";
	mso-ascii-font-family:"Calibri Light";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Calibri Light";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#2E74B5;
	mso-themecolor:accent1;
	mso-themeshade:191;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 2";
	mso-ansi-font-size:13.0pt;
	mso-bidi-font-size:13.0pt;
	font-family:"Calibri Light","sans-serif";
	mso-ascii-font-family:"Calibri Light";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Calibri Light";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#2E74B5;
	mso-themecolor:accent1;
	mso-themeshade:191;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 3";
	mso-ansi-font-size:12.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Calibri Light","sans-serif";
	mso-ascii-font-family:"Calibri Light";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Calibri Light";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#1F4D78;
	mso-themecolor:accent1;
	mso-themeshade:127;}
.MsoChpDefault
	{mso-style-type:export-only;
	mso-default-props:yes;
	font-family:"Calibri","sans-serif";
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-fareast-language:EN-US;}
.MsoPapDefault
	{mso-style-type:export-only;
	margin-bottom:8.0pt;
	line-height:107%;}
@page WordSection1
	{size:841.9pt 595.3pt;
	mso-page-orientation:landscape;
	margin:36.0pt 36.0pt 36.0pt 36.0pt;
	mso-header-margin:35.4pt;
	mso-footer-margin:35.4pt;
	mso-paper-source:0;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 @list l0
	{mso-list-id:237524588;
	mso-list-template-ids:1788099954;}
@list l0:level1
	{mso-level-start-at:3;
	mso-level-text:%1;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:18.0pt;
	text-indent:-18.0pt;}
@list l0:level2
	{mso-level-start-at:2;
	mso-level-text:"%1\.%2";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:18.0pt;
	text-indent:-18.0pt;}
@list l0:level3
	{mso-level-text:"%1\.%2\.%3";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:36.0pt;
	text-indent:-36.0pt;}
@list l0:level4
	{mso-level-text:"%1\.%2\.%3\.%4";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:36.0pt;
	text-indent:-36.0pt;}
@list l0:level5
	{mso-level-text:"%1\.%2\.%3\.%4\.%5";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:54.0pt;
	text-indent:-54.0pt;}
@list l0:level6
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:72.0pt;
	text-indent:-72.0pt;}
@list l0:level7
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:72.0pt;
	text-indent:-72.0pt;}
@list l0:level8
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7\.%8";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:90.0pt;
	text-indent:-90.0pt;}
@list l0:level9
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7\.%8\.%9";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:90.0pt;
	text-indent:-90.0pt;}
@list l1
	{mso-list-id:1432822512;
	mso-list-template-ids:1262807668;}
@list l1:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l1:level2
	{mso-level-legal-format:yes;
	mso-level-text:"%1\.%2\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:56.25pt;
	text-indent:-36.0pt;
	mso-ansi-font-size:11.0pt;}
@list l1:level3
	{mso-level-legal-format:yes;
	mso-level-text:"%1\.%2\.%3\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:58.5pt;
	text-indent:-36.0pt;
	mso-ansi-font-size:11.0pt;}
@list l1:level4
	{mso-level-legal-format:yes;
	mso-level-text:"%1\.%2\.%3\.%4\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:78.75pt;
	text-indent:-54.0pt;
	mso-ansi-font-size:11.0pt;}
@list l1:level5
	{mso-level-legal-format:yes;
	mso-level-text:"%1\.%2\.%3\.%4\.%5\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:81.0pt;
	text-indent:-54.0pt;
	mso-ansi-font-size:11.0pt;}
@list l1:level6
	{mso-level-legal-format:yes;
	mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:101.25pt;
	text-indent:-72.0pt;
	mso-ansi-font-size:11.0pt;}
@list l1:level7
	{mso-level-legal-format:yes;
	mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:121.5pt;
	text-indent:-90.0pt;
	mso-ansi-font-size:11.0pt;}
@list l1:level8
	{mso-level-legal-format:yes;
	mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7\.%8\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:123.75pt;
	text-indent:-90.0pt;
	mso-ansi-font-size:11.0pt;}
@list l1:level9
	{mso-level-legal-format:yes;
	mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7\.%8\.%9\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:144.0pt;
	text-indent:-108.0pt;
	mso-ansi-font-size:11.0pt;}
@list l2
	{mso-list-id:1518929815;
	mso-list-template-ids:-127619604;}
@list l2:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-18.0pt;}
@list l2:level2
	{mso-level-legal-format:yes;
	mso-level-text:"%1\.%2\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:40.5pt;
	text-indent:-22.5pt;}
@list l2:level3
	{mso-level-legal-format:yes;
	mso-level-text:"%1\.%2\.%3\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:54.0pt;
	text-indent:-36.0pt;}
@list l2:level4
	{mso-level-legal-format:yes;
	mso-level-text:"%1\.%2\.%3\.%4\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:54.0pt;
	text-indent:-36.0pt;}
@list l2:level5
	{mso-level-legal-format:yes;
	mso-level-text:"%1\.%2\.%3\.%4\.%5\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:72.0pt;
	text-indent:-54.0pt;}
@list l2:level6
	{mso-level-legal-format:yes;
	mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:72.0pt;
	text-indent:-54.0pt;}
@list l2:level7
	{mso-level-legal-format:yes;
	mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:90.0pt;
	text-indent:-72.0pt;}
@list l2:level8
	{mso-level-legal-format:yes;
	mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7\.%8\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:90.0pt;
	text-indent:-72.0pt;}
@list l2:level9
	{mso-level-legal-format:yes;
	mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7\.%8\.%9\.";
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:108.0pt;
	text-indent:-90.0pt;}
@list l3
	{mso-list-id:1542666166;
	mso-list-type:hybrid;
	mso-list-template-ids:-562012840 -1821096254 135462937 135462939 135462927 135462937 135462939 135462927 135462937 135462939;}
@list l3:level1
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:54.0pt;
	text-indent:-18.0pt;}
@list l3:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:90.0pt;
	text-indent:-18.0pt;}
@list l3:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:126.0pt;
	text-indent:-9.0pt;}
@list l3:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:162.0pt;
	text-indent:-18.0pt;}
@list l3:level5
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:198.0pt;
	text-indent:-18.0pt;}
@list l3:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:234.0pt;
	text-indent:-9.0pt;}
@list l3:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:270.0pt;
	text-indent:-18.0pt;}
@list l3:level8
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:306.0pt;
	text-indent:-18.0pt;}
@list l3:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	margin-left:342.0pt;
	text-indent:-9.0pt;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin-top:0cm;
	mso-para-margin-right:0cm;
	mso-para-margin-bottom:8.0pt;
	mso-para-margin-left:0cm;
	line-height:107%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-fareast-language:EN-US;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1026"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=NL-BE link="#0563C1" vlink="#954F72" style='tab-interval:35.4pt'>

<div class=WordSection1>

<p class=MsoTitle align=center style='text-align:center'>ABMaterial 2.17
Update/Upgrade CheckList</p>

<h1 style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l2 level1 lfo1'><![if !supportLists]><span
style='mso-fareast-font-family:"Calibri Light";mso-fareast-theme-font:major-latin;
mso-bidi-font-family:"Calibri Light";mso-bidi-theme-font:major-latin'><span
style='mso-list:Ignore'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>Introduction</h1>

<p class=MsoNormal style='margin-left:18.0pt'><span lang=EN-US
style='mso-ansi-language:EN-US'>This document is based on the Template project
of ABMaterial 2.17.<o:p></o:p></span></p>

<h2 style='margin-left:18.0pt'><span lang=EN-US style='mso-ansi-language:EN-US'>1.1.
The flow in ABMaterial 2.17+</span><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='font-size:14.0pt;line-height:107%;mso-ansi-language:EN-US'><o:p></o:p></span></b></h2>

<p class=MsoListParagraphCxSpFirst style='margin-left:54.0pt;mso-add-space:
auto;text-indent:-18.0pt;mso-list:l1 level1 lfo3'><![if !supportLists]><span
lang=EN-US style='mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;
mso-ansi-language:EN-US'><span style='mso-list:Ignore'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
lang=EN-US style='mso-ansi-language:EN-US'>You start compiled .jar file on your
server (e.g. </span><span lang=EN-US style='font-family:"Courier New";
mso-ansi-language:EN-US'>java -jar MyApp.jar</span><span lang=EN-US
style='mso-ansi-language:EN-US'>)<o:p></o:p></span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:54.0pt;mso-add-space:
auto;text-indent:-18.0pt;mso-list:l1 level1 lfo3'><![if !supportLists]><span
lang=EN-US style='mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;
mso-ansi-language:EN-US'><span style='mso-list:Ignore'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
lang=EN-US style='mso-ansi-language:EN-US'>A user loads the app in his browser
(e.g</span><span lang=EN-US style='mso-bidi-font-family:"Courier New";
mso-ansi-language:EN-US'>. </span><a href="http://localhost:51042/MyApp"><span
lang=EN-US style='font-family:"Courier New";mso-ansi-language:EN-US'>http://localhost:51042/MyApp</span></a><span
lang=EN-US style='mso-ansi-language:EN-US'>)<o:p></o:p></span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:54.0pt;mso-add-space:
auto;text-indent:-18.0pt;mso-list:l1 level1 lfo3'><![if !supportLists]><span
lang=EN-US style='mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;
mso-ansi-language:EN-US'><span style='mso-list:Ignore'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
lang=EN-US style='mso-ansi-language:EN-US'>The WebApp redirects the user to <b
style='mso-bidi-font-weight:normal'>InitialPage </b>defined in ABMApplication<o:p></o:p></span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:54.0pt;mso-add-space:
auto;text-indent:-18.0pt;mso-list:l1 level1 lfo3'><![if !supportLists]><span
lang=EN-US style='mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;
mso-ansi-language:EN-US'><span style='mso-list:Ignore'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
lang=EN-US style='mso-ansi-language:EN-US'>If no session exists for this user,
it enters the ABMSessionCreator class.<span style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:54.0pt;mso-add-space:
auto;text-indent:-18.0pt;mso-list:l1 level1 lfo3'><![if !supportLists]><span
lang=EN-US style='mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;
mso-ansi-language:EN-US'><span style='mso-list:Ignore'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
lang=EN-US style='mso-ansi-language:EN-US'>A new instance of your page class is
created (Initialize is called, we call the BuildPage() method containing the
GRID structure of our page).<o:p></o:p></span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:54.0pt;mso-add-space:
auto;text-indent:-18.0pt;mso-list:l1 level1 lfo3'><![if !supportLists]><span
lang=EN-US style='mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;
mso-ansi-language:EN-US'><span style='mso-list:Ignore'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
lang=EN-US style='mso-ansi-language:EN-US'>WebSocket_Connected is called when
the DOM of the page in the browser is fully loaded: <o:p></o:p></span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:54.0pt;mso-add-space:
auto'><span lang=EN-US style='mso-ansi-language:EN-US'>If it is a <b
style='mso-bidi-font-weight:normal'>new session</b>, We initialize the page
object and save everything in the <b style='mso-bidi-font-weight:normal'>cache</b>.<o:p></o:p></span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:54.0pt;mso-add-space:
auto'><span lang=EN-US style='mso-ansi-language:EN-US'>If it is an <b
style='mso-bidi-font-weight:normal'>existing session</b>, the page and all
global variables are restored from the <b style='mso-bidi-font-weight:normal'>cache</b>.<o:p></o:p></span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:54.0pt;mso-add-space:
auto;text-indent:-18.0pt;mso-list:l1 level1 lfo3'><![if !supportLists]><span
lang=EN-US style='mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;
mso-ansi-language:EN-US'><span style='mso-list:Ignore'>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
lang=EN-US style='mso-ansi-language:EN-US'>Everything is send to the
Browser.<span style='mso-spacerun:yes'> </span>We finish this method by doing
a <b style='mso-bidi-font-weight:normal'>page.Refresh</b> and tell the browser
were done by calling <b style='mso-bidi-font-weight:normal'>page.FinishedLoading</b><o:p></o:p></span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:54.0pt;mso-add-space:
auto;text-indent:-18.0pt;mso-list:l1 level1 lfo3'><![if !supportLists]><span
lang=EN-US style='mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;
mso-ansi-language:EN-US'><span style='mso-list:Ignore'>8.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
lang=EN-US style='mso-ansi-language:EN-US'>When the user leaves the page, a <b
style='mso-bidi-font-weight:normal'>beforeunload </b>event is raised.<o:p></o:p></span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:54.0pt;mso-add-space:
auto;text-indent:-18.0pt;mso-list:l1 level1 lfo3'><![if !supportLists]><span
lang=EN-US style='mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;
mso-ansi-language:EN-US'><span style='mso-list:Ignore'>9.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
lang=EN-US style='mso-ansi-language:EN-US'>WebSocket_Disconnected is called.<o:p></o:p></span></p>

<p class=MsoListParagraphCxSpLast style='margin-left:54.0pt;mso-add-space:auto;
text-indent:-18.0pt;mso-list:l1 level1 lfo3'><![if !supportLists]><span
lang=EN-US style='mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;
mso-ansi-language:EN-US'><span style='mso-list:Ignore'>10.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span></span><![endif]><span
lang=EN-US style='mso-ansi-language:EN-US'>If no reconnection happens after
some time, the session is destroyed by the server.<span
style='mso-spacerun:yes'> </span>De cache scavenger will do some cleanup.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:18.0pt'><span lang=EN-US
style='mso-ansi-language:EN-US'>If a user comes back to the app while the page
is still in cache, it will continue with the cached page.<span
style='mso-spacerun:yes'> </span>If the cached page is gone, the user is
redirected to the entry point of the app.<span style='mso-spacerun:yes'>
</span>Note that while the user is still connected with the internet, the
browser will periodically send a heartbeat to the server to keep the session
Alive.<o:p></o:p></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
mso-border-alt:solid windowtext .5pt;padding:1.0pt 4.0pt 1.0pt 0cm'>

<p class=MsoNormal style='text-indent:18.0pt;border:none;mso-border-alt:solid windowtext .5pt;
padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 0cm'><span lang=EN-US
style='mso-ansi-language:EN-US'>An ABMaterial project has the following
components (<span style='color:red'>RED</span> means things that <b
style='mso-bidi-font-weight:normal'>NEED</b> to be changed to work with/upgrade
to ABMaterial 2.17+, or are very important).<o:p></o:p></span></p>

</div>

<h2 style='margin-left:18.0pt'><span lang=EN-US style='mso-ansi-language:EN-US'>1.2.
The components of an ABMaterial project<o:p></o:p></span></h2>

<h3 style='margin-left:18.0pt'><span lang=EN-US style='mso-ansi-language:EN-US'>1.2.1.
Main<o:p></o:p></span></h3>

<p class=MsoListParagraph style='margin-left:18.0pt;mso-add-space:auto'><span
lang=EN-US style='mso-ansi-language:EN-US'>The B4J app starting point.<span
style='mso-spacerun:yes'> </span>Additional to normal B4J initializations,
this is the place where you create the ABMApplication and add your own WebApp
pages.<span style='mso-spacerun:yes'> </span>Finaly, you start the Server.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";mso-ansi-language:EN-US'>'Non-UI application (console / server
application)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";mso-ansi-language:EN-US'>#Region<span style='mso-spacerun:yes'>
</span>Project Attributes <o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";mso-ansi-language:EN-US'><span style='mso-tab-count:1'> </span>#CommandLineArgs:<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";mso-ansi-language:EN-US'><span style='mso-tab-count:1'> </span>#MergeLibraries:
True <o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";mso-ansi-language:EN-US'>#End Region<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";mso-ansi-language:EN-US'>Sub <span style='mso-bidi-font-weight:
bold'>Process_Globals</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";mso-ansi-language:EN-US'><span style='mso-tab-count:1'> </span><span
style='color:red'>Public srvr As Server</span><span style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";mso-ansi-language:EN-US'>Sub <span style='mso-bidi-font-weight:
bold'>AppStart</span> (Args() As String)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
35.4pt;line-height:normal;mso-layout-grid-align:none;text-autospace:none'><span
lang=EN-US style='font-size:8.0pt;font-family:"Courier New";color:red;
mso-ansi-language:EN-US'>' the user needs to login<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";color:red;mso-ansi-language:EN-US'><span style='mso-tab-count:
1'> </span>'ABMShared.NeedsAuthorization = True<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";mso-ansi-language:EN-US'><span style='mso-tab-count:1'> </span><span
style='color:red'>' Build the Theme<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";color:red;mso-ansi-language:EN-US'><span style='mso-tab-count:
1'> </span>ABMShared.BuildTheme(&quot;mytheme&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";color:red;mso-ansi-language:EN-US'><span style='mso-tab-count:
1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";color:red;mso-ansi-language:EN-US'><span style='mso-tab-count:
1'> </span>' create the app<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";color:red;mso-ansi-language:EN-US'><span style='mso-tab-count:
1'> </span>Dim myApp As ABMApplication<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";color:red;mso-ansi-language:EN-US'><span style='mso-tab-count:
1'> </span>myApp.Initialize<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";color:red;mso-ansi-language:EN-US'><span style='mso-tab-count:
2'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";color:red;mso-ansi-language:EN-US'><span style='mso-tab-count:
1'> </span>' create the pages<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";color:red;mso-ansi-language:EN-US'><span style='mso-tab-count:
1'> </span>Dim myPage As ABMPageTemplate<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";color:red;mso-ansi-language:EN-US'><span style='mso-tab-count:
1'> </span>myPage.Initialize<span style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";color:red;mso-ansi-language:EN-US'><span style='mso-tab-count:
1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";color:red;mso-ansi-language:EN-US'><span style='mso-tab-count:
1'> </span>' add the pages to the app<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";color:red;mso-ansi-language:EN-US'><span style='mso-tab-count:
1'> </span>myApp.AddPage(myPage.Page)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";color:red;mso-ansi-language:EN-US'><span style='mso-tab-count:
1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";color:red;mso-ansi-language:EN-US'><span style='mso-tab-count:
1'> </span>' start the server<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";color:red;mso-ansi-language:EN-US'><span style='mso-tab-count:
1'> </span>myApp.StartServer(srvr, &quot;srvr&quot;, 51042)<span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";color:red;mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";color:red;mso-ansi-language:EN-US'><span style='mso-tab-count:
1'> </span>' optional if you want to redirect the logs to a file in release
mode <o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";color:red;mso-ansi-language:EN-US'><span style='mso-tab-count:
1'> </span>ABMShared.RedirectOutput(File.DirApp, &quot;logs.txt&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";color:red;mso-ansi-language:EN-US'><span style='mso-tab-count:
1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";color:red;mso-ansi-language:EN-US'><span style='mso-tab-count:
1'> </span></span><span style='font-size:8.0pt;font-family:"Courier New";
color:red'>StartMessageLoop<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:18.0pt'><span style='font-size:8.0pt;
line-height:107%;font-family:"Courier New"'>End Sub</span><span lang=EN-US
style='mso-ansi-language:EN-US'><o:p></o:p></span></p>

<h3 style='margin-left:18.0pt'><span lang=EN-US style='mso-ansi-language:EN-US'>1.2.2.
ABMApplication<o:p></o:p></span></h3>

<p class=MsoListParagraphCxSpFirst style='margin-left:18.0pt;mso-add-space:
auto'><span lang=EN-US style='mso-ansi-language:EN-US'>The ABMaterial
application.<span style='mso-spacerun:yes'> </span>Here you can set general
properties for the WebApp.<span style='mso-spacerun:yes'> </span>In general,
this does not need much changes and can be left as is. <o:p></o:p></span></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:18.0pt;mso-add-space:
auto'><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<div style='mso-element:para-border-div;border:solid windowtext 1.0pt;
mso-border-alt:solid windowtext .5pt;padding:1.0pt 4.0pt 1.0pt 4.0pt;
margin-left:18.0pt;margin-right:0cm'>

<p class=MsoListParagraphCxSpMiddle style='margin-left:0cm;mso-add-space:auto;
border:none;mso-border-alt:solid windowtext .5pt;padding:0cm;mso-padding-alt:
1.0pt 4.0pt 1.0pt 4.0pt'><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-ansi-language:EN-US'>IMPORTANT<o:p></o:p></span></b></p>

<p class=MsoListParagraphCxSpMiddle style='margin-left:18.0pt;mso-add-space:
auto;text-indent:-18.0pt;mso-list:l3 level1 lfo4;border:none;mso-border-alt:
solid windowtext .5pt;padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><![if !supportLists]><span
lang=EN-US style='mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;
mso-ansi-language:EN-US'><span style='mso-list:Ignore'>a.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
lang=EN-US style='mso-ansi-language:EN-US'>Set the Initial starting page using
the <b style='mso-bidi-font-weight:normal'>InitialPage</b> variable in
Class_Globals<o:p></o:p></span></p>

<p class=MsoListParagraphCxSpLast style='margin-left:18.0pt;mso-add-space:auto;
text-indent:-18.0pt;mso-list:l3 level1 lfo4;border:none;mso-border-alt:solid windowtext .5pt;
padding:0cm;mso-padding-alt:1.0pt 4.0pt 1.0pt 4.0pt'><![if !supportLists]><span
lang=EN-US style='mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;
mso-ansi-language:EN-US'><span style='mso-list:Ignore'>b.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
lang=EN-US style='mso-ansi-language:EN-US'>Set the Application name (<u>do not
use spaces or special characters!</u>).<span style='mso-spacerun:yes'>
</span>This is the entry point to your WebApp and all pages will be creater
under this.<span style='mso-spacerun:yes'> </span>You can use <b
style='mso-bidi-font-weight:normal'>ABMShared.AppName</b> in the initialize()
method.<o:p></o:p></span></p>

</div>

<h3 style='margin-left:18.0pt'>1.2.3. ABMSessionCreator</h3>

<p class=MsoListParagraph style='margin-left:18.0pt;mso-add-space:auto'><span
lang=EN-US style='mso-ansi-language:EN-US'>The ABMSessionCreator is a B4J
filter which regulates a new websocket connection. In general, this does not
need much changes and can be left as is.<span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<h3 style='margin-left:18.0pt'><span lang=EN-US style='mso-ansi-language:EN-US'>1.2.4.
ABMUploadHandler<o:p></o:p></span></h3>

<p class=MsoNormal style='text-indent:18.0pt'><span lang=EN-US
style='mso-ansi-language:EN-US'>The ABMUploadHandler is a B4J Server Handler
that handles the uploads from the user.<span style='mso-spacerun:yes'>
</span>In general, this does not need much changes and can be left as is.<span
style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<h3 style='margin-left:18.0pt'><span lang=EN-US style='mso-ansi-language:EN-US'>1.2.5.
ABMCacheScavenger<o:p></o:p></span></h3>

<p class=MsoNormal style='margin-left:18.0pt'><span lang=EN-US
style='mso-ansi-language:EN-US'>Its job is taking care of <b style='mso-bidi-font-weight:
normal'>cleaning the cached pages</b> to preserve memory in the server app.<o:p></o:p></span></p>

<h3 style='margin-left:18.0pt'><span lang=EN-US style='mso-ansi-language:EN-US'>1.2.6.
ABMShared<o:p></o:p></span></h3>

<p class=MsoListParagraph style='margin-left:18.0pt;mso-add-space:auto'><span
lang=EN-US style='mso-ansi-language:EN-US'>A B4J module where code is shared
between all users.<span style='mso-spacerun:yes'> </span>It can be useful to
write general methods shortcuts to create a header, themes, or the navigation
bar.<span style='mso-spacerun:yes'> </span>It also must contain the
NavigateToPage method.<o:p></o:p></span></p>

<h3 style='margin-left:18.0pt'><span lang=EN-US style='mso-ansi-language:EN-US'>1.2.7.
ABMPages (your own pages)<o:p></o:p></span></h3>

<p class=MsoNormal style='margin-left:18.0pt'><span lang=EN-US
style='mso-ansi-language:EN-US'>These are your actual WebApp pages containing
your own ABMaterial components and logic.<span style='mso-spacerun:yes'>
</span>An ABM Web Page NEEDS a certain structure and methods.<span
style='mso-spacerun:yes'> </span>You can use (copy) the ABMPageTemplate and
ABMPageTemplateAlternative (see further) classes to get started with your own
pages.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:18.0pt'><span lang=EN-US
style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<span lang=EN-US style='font-size:11.0pt;line-height:107%;font-family:"Calibri","sans-serif";
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:Calibri;mso-fareast-theme-font:
minor-latin;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US;mso-fareast-language:
EN-US;mso-bidi-language:AR-SA'><br clear=all style='mso-special-character:line-break;
page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h1 style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l2 level1 lfo1'><![if !supportLists]><span
lang=EN-US style='mso-fareast-font-family:"Calibri Light";mso-fareast-theme-font:
major-latin;mso-bidi-font-family:"Calibri Light";mso-bidi-theme-font:major-latin;
mso-ansi-language:EN-US'><span style='mso-list:Ignore'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
lang=EN-US style='mso-ansi-language:EN-US'>Preparation to upgrade/update from
ABMaterial versions BEFORE 2.17<o:p></o:p></span></h1>

<p class=MsoNormal style='margin-left:18.0pt'><span lang=EN-US
style='mso-ansi-language:EN-US'>If you are new, read them too as it contains
some explaining on how the inner workings of ABMaterial work.<o:p></o:p></span></p>

<h2 style='margin-left:40.5pt;text-indent:-22.5pt;mso-list:l2 level2 lfo1'><![if !supportLists]><span
style='mso-fareast-font-family:"Calibri Light";mso-fareast-theme-font:major-latin;
mso-bidi-font-family:"Calibri Light";mso-bidi-theme-font:major-latin'><span
style='mso-list:Ignore'>2.1.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span></span><![endif]>ABMShared</h2>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span style='font-size:8.0pt;
line-height:107%;font-family:"Courier New"'>Sub Process_Globals<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span style='font-size:8.0pt;
line-height:107%;font-family:"Courier New"'><span style='mso-tab-count:1'> </span>Public
MyTheme As ABMTheme<span style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Private ABM As ABMaterial 'ignore<span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Public NeedsAuthorization As Boolean = False<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><span style='color:red'>Public AppVersion As
String = DateTime.now</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Public AppPublishedStartURL As String =
&quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Public AppName As String = &quot;&quot;<span
style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><span style='color:red'>Public CachedPages As
Map<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>Public
CacheScavengePeriodSeconds As Int = 15*60 </span><span lang=EN-US
style='font-size:8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:
EN-US'>' 15 minutes ' 10 minutes<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><span style='color:red'>Public
SessionMaxInactiveIntervalSeconds As Int = 30*60 </span>' 30 minutes <o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:53.4pt;margin-bottom:.0001pt;text-indent:35.4pt'><span lang=EN-US
style='font-size:8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:
EN-US'>'1*60*60 ' one hour ' -1 = immortal but beware! This means the cache is
NEVER emptied!<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:
EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:18.0pt'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-ansi-language:EN-US'>CacheScavengePeriodSeconds</span></b><span
lang=EN-US style='mso-ansi-language:EN-US'>: this is the interval the Scavenger
will try to clean up disconnected pages.<span style='mso-spacerun:yes'>
</span>They will not be cleaned up as long as the websocket has a 'working'
session. (Default 15 minutes)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:18.0pt'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-ansi-language:EN-US'>SessionMaxInactiveIntervalSeconds</span></b><span
lang=EN-US style='mso-ansi-language:EN-US'>: this is an important one where you
have to decide how you want your app to work.<span style='mso-spacerun:yes'>
</span>In case of an app with little new connection, you can put this up rather
high (days).<span style='mso-spacerun:yes'> </span>But if you have a lot of
new/different connections, you better set this lower to free up meomory in the
server app. (Default 30 minutes)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:18.0pt'><b style='mso-bidi-font-weight:
normal'><i style='mso-bidi-font-style:normal'><span lang=EN-US
style='mso-ansi-language:EN-US'>The new NavigateToPage method<o:p></o:p></span></i></b></p>

<p class=MsoNormal style='margin-left:18.0pt'><span lang=EN-US
style='mso-ansi-language:EN-US'>As we are leaving the page here, we can remove
the cached version here instead of waiting for the Scavenger.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>Public
Sub NavigateToPage(ws As WebSocket, PageId As String, TargetUrl As String)<span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>If AppVersion &lt;&gt; &quot;&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>TargetUrl = TargetUrl &amp;
&quot;?&quot; &amp; AppVersion<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><span style='color:red'>ABM.RemoveMeFromCache(CachedPages,
PageId)</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>If ws.Open Then<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>ws.Eval(&quot;window.location =
arguments[0]&quot;, Array As Object(TargetUrl))<span style='mso-tab-count:3'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>ws.Flush<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub</span><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:18.0pt'><b style='mso-bidi-font-weight:
normal'><i style='mso-bidi-font-style:normal'><span lang=EN-US
style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></i></b></p>

<b style='mso-bidi-font-weight:normal'><i style='mso-bidi-font-style:normal'><span
lang=EN-US style='font-size:11.0pt;line-height:107%;font-family:"Calibri","sans-serif";
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:Calibri;mso-fareast-theme-font:
minor-latin;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US;mso-fareast-language:
EN-US;mso-bidi-language:AR-SA'><br clear=all style='mso-special-character:line-break;
page-break-before:always'>
</span></i></b>

<p class=MsoNormal style='margin-left:18.0pt'><b style='mso-bidi-font-weight:
normal'><i style='mso-bidi-font-style:normal'><span lang=EN-US
style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></i></b></p>

<p class=MsoNormal style='margin-left:18.0pt'><b style='mso-bidi-font-weight:
normal'><i style='mso-bidi-font-style:normal'><span lang=EN-US
style='mso-ansi-language:EN-US'>Or an alternative so the user can open multiple
tabs of the same page, except on mobiles/tablets.<o:p></o:p></span></i></b></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>Public
Sub NavigateToPageNewTab(ws As WebSocket, PageId As String, TargetUrl As
String, OpenInNewTab As Boolean)<span style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>If AppVersion &lt;&gt; &quot;&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>TargetUrl = TargetUrl &amp;
&quot;?&quot; &amp; AppVersion<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><span style='color:red'>ABM.RemoveMeFromCache(CachedPages,
PageId)<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>If ws.Open Then<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>If OpenInNewTab Then<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span>Dim s As String<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span>' check if a mobile phone only<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>'<span
style='mso-tab-count:3'> </span>s = $&quot;var check = false;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>'<span
style='mso-spacerun:yes'> </span><span style='mso-tab-count:2'> </span><span
style='mso-tab-count:1'> </span>(function(a){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge
|maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm(
os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows
ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a
wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r
|s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1
u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp(
i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac(
|\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt(
|\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg(
g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-|
|o|v)|zz)|mt(50|p1|v
)|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v
)|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-|
)|webc|whit|wi(g
|nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4))) check =
true;})(navigator.userAgent||navigator.vendor||window.opera);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>'<span
style='mso-spacerun:yes'> </span><span style='mso-tab-count:3'> </span>if
(check) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>'<span
style='mso-spacerun:yes'> </span><span style='mso-tab-count:4'> </span>window.location
= arguments[0];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>'<span
style='mso-spacerun:yes'> </span><span style='mso-tab-count:3'> </span>}
else {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>'<span
style='mso-spacerun:yes'> </span><span style='mso-tab-count:4'> </span>window.open(arguments[0],'_blank');<span
style='mso-spacerun:yes'> </span><span style='mso-tab-count:4'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>'<span
style='mso-spacerun:yes'> </span><span style='mso-tab-count:3'> </span>}&quot;$<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span>' check if a mobile phone or a
tablet<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span>s = $&quot;var check = false;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span><span style='mso-tab-count:2'> </span><span
style='mso-tab-count:1'> </span>(function(a){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge
|maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm(
os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows
ce|xda|xiino|android|ipad|playbook|silk/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a
wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r
|s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1
u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp(
i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac(
|\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt(
|\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-|
|o|v)|zz)|mt(50|p1|v
)|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v
)|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-|
)|webc|whit|wi(g
|nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4))) check =
true;})(navigator.userAgent||navigator.vendor||window.opera);<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span><span style='mso-tab-count:3'> </span>if
(check) {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span><span style='mso-tab-count:4'> </span>window.location
= arguments[0];<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span><span style='mso-tab-count:3'> </span>}
else {<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:4'> </span>window.open(arguments[0],'_blank');<span
style='mso-spacerun:yes'> </span><span style='mso-tab-count:4'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span><span style='mso-tab-count:3'> </span>}&quot;$<span
style='mso-tab-count:3'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span>ws.Eval(s, Array As
Object(TargetUrl))<span style='mso-tab-count:7'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>Else<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span>ws.Eval(&quot;window.location =
arguments[0]&quot;, Array As Object(TargetUrl))<span style='mso-tab-count:2'> </span><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>ws.Flush<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:18.0pt'><span lang=EN-US
style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:18.0pt'><b style='mso-bidi-font-weight:
normal'><i style='mso-bidi-font-style:normal'><span lang=EN-US
style='mso-ansi-language:EN-US'>Handy method to redirect the log output to a
file in release mode:<o:p></o:p></span></i></b></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>Sub
RedirectOutput (Dir As String, FileName As String) 'ignore<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>#if RELEASE<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Dim out As OutputStream =
File.OpenOutput(Dir, FileName, False) 'Set to True to append the logs<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Dim ps As JavaObject<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>
</span>ps.InitializeNewInstance(&quot;java.io.PrintStream&quot;, Array(out,
True, &quot;utf8&quot;))<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>Dim jo As JavaObject<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'>
</span>jo.InitializeStatic(&quot;java.lang.System&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>jo.RunMethod(&quot;setOut&quot;, Array(ps))<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>jo.RunMethod(&quot;setErr&quot;, Array(ps))<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>#end if<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:18.0pt'><span lang=EN-US
style='mso-ansi-language:EN-US'>If you use LogOff, you also will have to change
this method (You can use page.GetPageID as the pageID parameter)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";mso-ansi-language:EN-US'>Sub <b>LogOff</b>(page As ABMPage)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:53.4pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";mso-ansi-language:EN-US'>' do whatever you have to do to log off
your user<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:53.4pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";mso-ansi-language:EN-US'><span style='mso-tab-count:2'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:53.4pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";mso-ansi-language:EN-US'>page.ws.Session.SetAttribute(&quot;IsAuthorized&quot;,
&quot;&quot;)<span style='mso-tab-count:4'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:53.4pt;margin-bottom:.0001pt;line-height:normal;mso-layout-grid-align:
none;text-autospace:none'><span lang=EN-US style='font-size:8.0pt;font-family:
"Courier New";mso-ansi-language:EN-US'>NavigateToPage(page.ws, <span
style='color:red'>page.GetPageID</span>, &quot;../&quot;)<span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<span lang=EN-US style='font-size:11.0pt;line-height:107%;font-family:"Calibri","sans-serif";
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:Calibri;mso-fareast-theme-font:
minor-latin;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US;mso-fareast-language:
EN-US;mso-bidi-language:AR-SA'><br clear=all style='mso-special-character:line-break;
page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-US style='font-size:13.0pt;line-height:107%;
font-family:"Calibri Light","sans-serif";mso-ascii-theme-font:major-latin;
mso-fareast-font-family:"Times New Roman";mso-fareast-theme-font:major-fareast;
mso-hansi-theme-font:major-latin;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:major-bidi;color:#2E74B5;mso-themecolor:accent1;mso-themeshade:
191;mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h2 style='margin-left:40.5pt;text-indent:-22.5pt;mso-list:l2 level2 lfo1'><![if !supportLists]><span
style='mso-fareast-font-family:"Calibri Light";mso-fareast-theme-font:major-latin;
mso-bidi-font-family:"Calibri Light";mso-bidi-theme-font:major-latin'><span
style='mso-list:Ignore'>2.2.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span></span><![endif]>ABMSessionCreator</h2>

<p class=MsoNormal style='margin-left:18.0pt'><span lang=EN-US
style='mso-ansi-language:EN-US'>Worth noticing is that we no <b
style='mso-bidi-font-weight:normal'>NOT use ABMNewSession </b>any more.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>'Filter
class<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>Sub
Class_Globals<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>Public
Sub Initialize<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>'Return
True to allow the request to proceed.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>Public
Sub Filter(req As ServletRequest, resp As ServletResponse) As Boolean<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>DateTime.DateFormat = &quot;dd/MM/yyyy&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>DateTime.TimeFormat = &quot;HH:mm&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Log(&quot;In filter: &quot; &amp;
DateTime.Date(DateTime.Now) &amp; &quot; &quot; &amp;
DateTime.Time(DateTime.now))<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><span style='color:red'>req.GetSession</span><span
style='mso-spacerun:yes'> </span>'a new session will be created if a session
doesn't exist.<span style='mso-tab-count:3'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span></span><span style='font-size:8.0pt;
line-height:107%;font-family:"Courier New";color:red'>Return True</span><span
style='font-size:8.0pt;line-height:107%;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span style='font-size:8.0pt;
line-height:107%;font-family:"Courier New"'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt'><o:p>&nbsp;</o:p></p>

<h2 style='margin-left:40.5pt;text-indent:-22.5pt;mso-list:l2 level2 lfo1'><![if !supportLists]><span
style='mso-fareast-font-family:"Calibri Light";mso-fareast-theme-font:major-latin;
mso-bidi-font-family:"Calibri Light";mso-bidi-theme-font:major-latin'><span
style='mso-list:Ignore'>2.3.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span></span><![endif]>ABMCacheScavenger
(New Class)</h2>

<p class=MsoNormal style='margin-left:18.0pt'><span lang=EN-US
style='mso-ansi-language:EN-US'>Its job is taking care of <b style='mso-bidi-font-weight:
normal'>cleaning the cached pages</b> to preserve memory in the server app.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'>'CacheScavenger<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'>Sub Class_Globals<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-spacerun:yes'> </span>Private scavengeTimer As
Timer<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-spacerun:yes'> </span>Private ABM As ABMaterial<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'>Public Sub Initialize<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span><span
style='mso-spacerun:yes'></span>scavengeTimer.Initialize(&quot;ScavengeTimer&quot;,
ABMShared.CacheScavengePeriodSeconds * 1000)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span><span
style='mso-spacerun:yes'></span>scavengeTimer.Enabled = True<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span><span
style='mso-spacerun:yes'></span>StartMessageLoop '&lt;- don't forget!<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'>Sub ScavengeTimer_Tick<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-spacerun:yes'> </span><span style='mso-tab-count:1'> </span>'do
the work required<span style='mso-tab-count:2'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-spacerun:yes'> </span><span style='mso-tab-count:1'> </span>ABM.ScavengeCache(ABMShared.CachedPages)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h2 style='margin-left:40.5pt;text-indent:-22.5pt;mso-list:l2 level2 lfo1'><![if !supportLists]><span
style='mso-fareast-font-family:"Calibri Light";mso-fareast-theme-font:major-latin;
mso-bidi-font-family:"Calibri Light";mso-bidi-theme-font:major-latin'><span
style='mso-list:Ignore'>2.4.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span></span><![endif]>ABMApplication</h2>

<p class=MsoNormal style='margin-left:18.0pt'><span lang=EN-US
style='mso-ansi-language:EN-US'>The <b style='mso-bidi-font-weight:normal'>Page_Ready</b>
event does <b style='mso-bidi-font-weight:normal'>not exist any more</b> (and
will never be raised!).<span style='mso-spacerun:yes'> </span>Instead move
this code (without the call to connectPage() else we loop), at the end of your
Connect_Page() method. There is little need to make changes in this class,
except if you are more of an exprert and want to add your own login system for
example.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>'Main
application<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>Sub
Class_Globals<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' change to match you app<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Private InitialPage As String =
&quot;ABMPageTemplate&quot;<span style='mso-spacerun:yes'>
</span>'&lt;-------- First page to load<span style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' NOTE: Once you've set the above parameters,
run the App once.<span style='mso-spacerun:yes'> </span>That way, the complete
folder structure for your app will be created<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' /appname/ <o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' /appname/images/<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' /appname/uploads/<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' You can then put the images you need in the
pages into the /appname/images/ folder and start using them.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' other variables needed<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Private AppPage As ABMPage<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Private theme As ABMTheme<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Private ws As WebSocket 'ignore<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Private ABM As ABMaterial 'ignore<span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Private Pages As List<span style='mso-tab-count:
1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Private PageNeedsUpload As List<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><span style='color:red'>Private ABMPageId As
String = &quot;&quot;</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>Public
Sub Initialize<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Pages.Initialize<span style='mso-tab-count:
1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>PageNeedsUpload.Initialize<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>ABM.AppVersion = ABMShared.AppVersion<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>ABM.AppPublishedStartURL =
ABMShared.AppPublishedStartURL<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>ABMShared.AppName = &quot;template&quot;<span
style='mso-spacerun:yes'>
</span>'&lt;-------------------------------------------------------- IMPORTANT<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' add your icons<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' ABM.AddAppleTouchIcon(&quot;&quot;,
&quot;&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' ABM.AddMSTileIcon(&quot;&quot;,
&quot;&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' ABM.AddFavorityIcon(&quot;&quot;,
&quot;&quot;)<span style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>#If RELEASE<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>ABM.PreloadAllJavascriptAndCSSFiles=True<span
style='mso-tab-count:1'> </span>' NEW<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>ABM.ActivateGZip(&quot;DONATORKEY&quot;,
1000) ' NEW<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>ABM.AppDefaultPageCSSInline=True ' NEW<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><span style='mso-tab-count:1'> </span>ABM.AppDefaultPageJSInline=True
' NEW<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>Dim folders As List ' NEW<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>folders.Initialize<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>folders.Add(File.DirApp &amp;
&quot;/www/&quot; &amp; ABMShared.AppName &amp; &quot;/images&quot;)<span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>ABM.ActivatePNGOptimize(&quot;DONATORKEY&quot;,
folders, False , 9, False, True )<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>#End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' build the local structure IMPORTANT!<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>BuildPage<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='mso-bidi-font-family:
"Courier New";mso-ansi-language:EN-US'>At this point the initial page (what you
have done in the BuildPage() has been loaded in the browser.<span
style='mso-spacerun:yes'> </span>Before 2.17, a second event called Page_Ready
was needed, but this was not a very reliable way.<span
style='mso-spacerun:yes'> </span><b style='mso-bidi-font-weight:normal'>So now
when WebSocket_Connected() called, we know we have a html file and all
javascript libraries are loaded.</b><span style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='mso-bidi-font-family:
"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-ansi-language:EN-US'>In essence, this is ALL you do in
WebSocket_Connected!<span style='mso-spacerun:yes'> </span>NO additional
SetWebSockets, Page.Prepares or Page.Refreshes here</span></b><span lang=EN-US
style='mso-ansi-language:EN-US'>.<span style='mso-spacerun:yes'> </span>They
have all been handled.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:
EN-US'>ALSO: Do <b style='mso-bidi-font-weight:normal'>NOT</b> add
ABMComponents to your page here.<span style='mso-spacerun:yes'> </span>Use
ConnectPage for that (see further). The only thing you do here is things like
Initializing timers, setting/getting other session variables, getting setting
variables from the local storage.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='mso-bidi-font-family:
"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>Private
Sub WebSocket_Connected (WebSocket1 As WebSocket)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Log(&quot;Connected&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><span style='color:red'>ws = WebSocket1<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>ABMPageId =
ABM.GetPageID(AppPage, ABMShared.AppName,ws)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>Dim session As HttpSession =
ABM.GetSession(ws, ABMShared.SessionMaxInactiveIntervalSeconds) <o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' Prepare the page IMPORTANT!<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>AppPage.Prepare<span style='mso-tab-count:
1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' Run ConnectPage here in ABMApplication<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>ConnectPage<span style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' navigate to the first page<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>If ABMShared.NeedsAuthorization Then<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>If
Session.GetAttribute2(&quot;IsAuthorized&quot;, &quot;&quot;) = &quot;&quot;
Then<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span>AppPage.ShowModalSheet(&quot;login&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span>Return<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>ABMShared.NavigateToPage(ws,
&quot;&quot;,&quot;./&quot; &amp; InitialPage)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-ansi-language:EN-US'>WebSocket_Disconnected()</span></b><span
lang=EN-US style='mso-ansi-language:EN-US'> is a good place to stop your
timers.</span><span lang=EN-US style='font-size:8.0pt;line-height:107%;
font-family:"Courier New";mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>Private
Sub WebSocket_Disconnected<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Log(&quot;Disconnected&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt'><span
lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span>In ABMaterial 216+, a new special event
<b style='mso-bidi-font-weight:normal'>beforeunload</b> is called.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
18.0pt'><span lang=EN-US style='mso-ansi-language:EN-US'>There is no need to
add/change anything in Page_ParseEvent.<span style='mso-spacerun:yes'>
</span>Leave it as described below.</span><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>Sub
Page_ParseEvent(Params As Map) <o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Dim eventName As String =
Params.Get(&quot;eventname&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Dim eventParams() As String =
Regex.Split(&quot;,&quot;,Params.Get(&quot;eventparams&quot;))<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><span style='color:red'>If eventName =
&quot;beforeunload&quot; Then<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>Log(&quot;preparing for
url refresh&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>ABM.RemoveMeFromCache(ABMShared.CachedPages,
ABMPageId)<span style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>Return<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>If SubExists(Me, eventName) Then<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>Params.Remove(&quot;eventname&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>Params.Remove(&quot;eventparams&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>Select Case Params.Size<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span>Case 0<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:4'> </span>CallSub(Me, eventName)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span>Case 1<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:4'> </span>CallSub2(Me, eventName,
Params.Get(eventParams(0)))<span style='mso-tab-count:4'> </span><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span>Case 2<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:4'> </span>If
Params.get(eventParams(0)) = &quot;abmistable&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:5'> </span>Dim PassedTables
As List = ABM.ProcessTablesFromTargetName(Params.get(eventParams(1)))<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:5'> </span>CallSub2(Me,
eventName, PassedTables)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:4'> </span>Else<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:5'> </span>CallSub3(Me,
eventName, Params.Get(eventParams(0)), Params.Get(eventParams(1)))<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:4'> </span>End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span>Case Else<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:4'> </span>' cannot be called
diretly, to many param<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:4'> </span>CallSub2(Me, eventName,
Params)<span style='mso-tab-count:4'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>End Select<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='mso-bidi-font-family:
"Courier New";mso-ansi-language:EN-US'>Adds and writes your pages to disk
(everything you have written in a BuildPage() method.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>public
Sub AddPage(Page As ABMPage)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Pages.Add(Page.Name)<span style='mso-tab-count:
1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>PageNeedsUpload.Add(ABM.WritePageToDisk(Page,
File.DirApp &amp; &quot;/www/&quot; &amp; ABMShared.AppName &amp; &quot;/&quot;
&amp; Page.Name &amp; &quot;/&quot;, Page.PageHTMLName,
ABMShared.NeedsAuthorization))<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='mso-bidi-font-family:
"Courier New";mso-ansi-language:EN-US'>Starts the server (two methods: HTTP1.1
and HTTP2).<span style='mso-spacerun:yes'> </span>In 2.17, we also have to add
our Scavenger as a BackgroundWorker (jServer 2.70+ is needed!, see the B4J
forum).<span style='mso-spacerun:yes'> </span>We also need to set the
IdleTimout on all the connections.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='mso-bidi-font-family:
"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='mso-bidi-font-family:
"Courier New";mso-ansi-language:EN-US'>Finally, we must initialize the
CachedPages map as a ThreadSafeMap which will hold our cached pages.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>public
Sub StartServer(srvr As Server, srvrName As String, srvrPort As Int)<span
style='mso-tab-count:2'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>ABM.WriteAppLauchPageToDisk(AppPage,
File.DirApp &amp; &quot;/www/&quot; &amp; ABMShared.AppName,
&quot;index.html&quot;, ABMShared.NeedsAuthorization)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' start the server<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>srvr.Initialize(srvrName)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>srvr.AddFilter(&quot;/js/b4j_ws.min.js&quot;,
&quot;ABMSessionCreator&quot;, False)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>srvr.AddWebSocket(&quot;/ws/&quot; &amp;
ABMShared.AppName, &quot;ABMApplication&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>For i =0 To Pages.Size - 1<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>srvr.AddWebSocket(&quot;/ws/&quot;
&amp; ABMShared.AppName &amp; &quot;/&quot; &amp; Pages.Get(i) , Pages.Get(i))<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>If PageNeedsUpload.Get(i) Then<span
style='mso-tab-count:3'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span>srvr.AddHandler(&quot;/&quot;
&amp; ABMShared.AppName &amp; &quot;/&quot; &amp; Pages.Get(i) &amp;
&quot;/abmuploadhandler&quot;, &quot;ABMUploadHandler&quot;, False)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Next<span style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><span style='color:red'>srvr.AddBackgroundWorker(&quot;ABMCacheScavenger&quot;)</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>srvr.Port = srvrPort<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>#If RELEASE<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>srvr.SetStaticFilesOptions(CreateMap(&quot;cacheControl&quot;:
&quot;max-age=604800,public&quot;,&quot;gzip&quot;:True,&quot;dirAllowed&quot;:False))<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>#Else<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>srvr.SetStaticFilesOptions(CreateMap(&quot;cacheControl&quot;:
&quot;max-age=604800,public&quot;,&quot;gzip&quot;:False,&quot;dirAllowed&quot;:False))<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>#End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>srvr.Start<span style='mso-tab-count:3'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><span style='color:red'>Dim jo As JavaObject
= srvr<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>Dim connectors() As Object =
jo.GetFieldJO(&quot;server&quot;).RunMethod(&quot;getConnectors&quot;, Null)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>Dim timeout As Long =
ABMShared.SessionMaxInactiveIntervalSeconds*1000<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>For Each c As JavaObject In
connectors<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>c.RunMethod(&quot;setIdleTimeout&quot;,
Array(timeout))<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>Next<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>ABMShared.CachedPages =
srvr.CreateThreadSafeMap<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>public
Sub StartServerHTTP2(srvr As Server, srvrName As String, srvrPort As Int,
SSLsvrPort As Int,<span style='mso-spacerun:yes'> </span>SSLKeyStoreFileName
As String, SSLKeyStorePassword As String, SSLKeyManagerPassword As String)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>ABM.WriteAppLauchPageToDisk(AppPage,
File.DirApp &amp; &quot;/www/&quot; &amp; ABMShared.AppName,
&quot;index.html&quot;, ABMShared.NeedsAuthorization)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Dim ssl As SslConfiguration<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>ssl.Initialize<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>ssl.SetKeyStorePath(File.DirApp,
SSLKeyStoreFileName) 'path to keystore file<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>ssl.KeyStorePassword = SSLKeyStorePassword<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>ssl.KeyManagerPassword =
SSLKeyManagerPassword<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>srvr.SetSslConfiguration(ssl, SSLsvrPort)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' start the server<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>srvr.Initialize(srvrName)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>srvr.AddFilter(&quot;/js/b4j_ws.min.js&quot;,
&quot;ABMSessionCreator&quot;, False)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>srvr.AddWebSocket(&quot;/ws/&quot; &amp;
ABMShared.AppName, &quot;ABMApplication&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>For i =0 To Pages.Size - 1<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>srvr.AddWebSocket(&quot;/ws/&quot;
&amp; ABMShared.AppName &amp; &quot;/&quot; &amp; Pages.Get(i) , Pages.Get(i))<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>If PageNeedsUpload.Get(i) Then<span
style='mso-tab-count:3'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span>srvr.AddHandler(&quot;/&quot;
&amp; ABMShared.AppName &amp; &quot;/&quot; &amp; Pages.Get(i) &amp;
&quot;/abmuploadhandler&quot;, &quot;ABMUploadHandler&quot;, False)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Next<span style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><span style='color:red'>srvr.AddBackgroundWorker(&quot;ABMCacheScavenger&quot;)</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>srvr.Port = srvrPort<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>srvr.Http2Enabled = True<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>#If RELEASE<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>srvr.SetStaticFilesOptions(CreateMap(&quot;cacheControl&quot;:
&quot;max-age=604800,public&quot;,&quot;gzip&quot;:True,&quot;dirAllowed&quot;:False))<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>#Else<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>srvr.SetStaticFilesOptions(CreateMap(&quot;cacheControl&quot;:
&quot;max-age=604800,public&quot;,&quot;gzip&quot;:False,&quot;dirAllowed&quot;:False))<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>#End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>srvr.Start<span style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><span style='color:red'>Dim jo As JavaObject
= srvr<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>Dim connectors() As Object =
jo.GetFieldJO(&quot;server&quot;).RunMethod(&quot;getConnectors&quot;, Null)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>Dim timeout As Long =
ABMShared.SessionMaxInactiveIntervalSeconds*1000<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>For Each c As JavaObject In
connectors<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>c.RunMethod(&quot;setIdleTimeout&quot;,
Array(timeout))<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>Next<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>ABMShared.CachedPages =
srvr.CreateThreadSafeMap<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:18.0pt'><span lang=EN-US
style='mso-ansi-language:EN-US'>Always load the base theme from ABMShared.<span
style='mso-spacerun:yes'> </span>You can add extra page specific themes to
it.<span style='mso-spacerun:yes'> </span>This is called when the server is
started, and is <b style='mso-bidi-font-weight:normal'>the only place in the
page where themes can be defined</b>!<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>public
Sub BuildTheme()<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' start with the base theme defined in
ABMShared<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>theme.Initialize(&quot;pagetheme&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>theme.AddABMTheme(ABMShared.MyTheme)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' add additional themes specific for this
page<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:18.0pt'><span lang=EN-US
style='mso-ansi-language:EN-US'>Here we build the initial STRUCTURE of the
page.<span style='mso-spacerun:yes'> </span>We can set some page properties
and we have to build our GRID.<span style='mso-spacerun:yes'> </span>You add
ABMcomponents here, but it is <b style='mso-bidi-font-weight:normal'>not
advisable</b>!<span style='mso-spacerun:yes'> </span>Components defined here
are static.<span style='mso-spacerun:yes'> </span>If you want dynamic
components, it is better to define them in ConnectPage.<span
style='mso-spacerun:yes'> </span>We can also add the ModalSheets here.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:18.0pt'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-ansi-language:EN-US'>NOTE: the page
Initialize methods have a new PARAMETER:</span></b><span lang=EN-US
style='mso-ansi-language:EN-US'> </span><span lang=EN-US style='font-size:8.0pt;
line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:EN-US'>ABMShared.SessionMaxInactiveIntervalSeconds</span><span
lang=EN-US style='font-size:8.0pt;line-height:107%;font-family:"Courier New";
mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>public
Sub BuildPage()<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' initialize the theme<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>BuildTheme<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' initialize this page using our theme<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>AppPage.InitializeWithTheme(ABMShared.AppName,
&quot;/ws/&quot; &amp; ABMShared.AppName, False,
ABMShared.SessionMaxInactiveIntervalSeconds , theme)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>AppPage.ShowLoader=True<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>AppPage.PageTitle = &quot;Template&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>AppPage.PageDescription = &quot;Template for
ABMaterial, a Material UI Framework for B4J&quot;<span style='mso-tab-count:
1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>AppPage.PageHTMLName = &quot;index.html&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>AppPage.PageKeywords = &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>AppPage.PageSiteMapPriority =
&quot;0.00&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>AppPage.PageSiteMapFrequency =
ABM.SITEMAP_FREQ_YEARLY<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' adding a navigation bar<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' create the page grid<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>AppPage.AddRows(1,True,
&quot;&quot;).AddCells12(1,&quot;&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>AppPage.BuildGrid 'IMPORTANT once you loaded
the complete grid AND before you start adding components<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' add a modal sheet template to enter contact
information<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>AppPage.AddModalSheetTemplate(BuildLoginSheet)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' add a error box template if the name is not
entered<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>AppPage.AddModalSheetTemplate(BuildWrongInputModalSheet)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<span lang=EN-US style='font-size:8.0pt;line-height:107%;font-family:"Courier New";
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-ansi-language:
EN-US;mso-fareast-language:EN-US;mso-bidi-language:AR-SA'><br clear=all
style='mso-special-character:line-break;page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;line-height:107%;
font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:18.0pt'><span lang=EN-US
style='mso-ansi-language:EN-US'>Here we define all our components! Note that
any definition of a component you make here, is purely <b style='mso-bidi-font-weight:
normal'>a mirror object</b> of what will be seen in the users browser.<span
style='mso-spacerun:yes'> </span>This is the reason we do not put dims om
ABMComponents in Global_Class as if you do, they are not synced with the
users browser.<span style='mso-spacerun:yes'> </span>Only when you use a
method like Page.Component(), the sync happens between the browser and the
server. (e.g. in an ABMInput component, the servers object will receive the
actual Text value the users entered in the browser).<span
style='mso-spacerun:yes'> </span>It is using the JQueryElement and Future
mechanism forseen by B4J.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:18.0pt'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-ansi-language:EN-US'>As Page_Ready() is
depreciated, we also have to add its code to the ConnectPage method!</span></b><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='font-size:8.0pt;
line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>public
Sub ConnectPage()<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' you dynamic stuff<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><span style='color:red'>AppPage.Refresh '
IMPORTANT<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>' Tell the browser we finished
loading<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>AppPage.FinishedLoading
'IMPORTANT<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>AppPage.RestoreNavigationBarPosition
'used to be in the depreciated Page_Ready() event!<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='mso-bidi-font-family:
"Courier New";mso-ansi-language:EN-US'>Some methods to handle the login system
in the application:<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>Sub
msbtn1_Clicked(Target As String)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Dim mymodal As ABMModalSheet =
AppPage.ModalSheet(&quot;login&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Dim inp1 As ABMInput =
mymodal.Content.Component(&quot;inp1&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Dim inp2 As ABMInput = mymodal.Content.Component(&quot;inp2&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' here check the login a page against your
login database<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>If inp1.Text &lt;&gt; &quot;demo&quot; Or
inp2.Text &lt;&gt; &quot;demo&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>AppPage.ShowModalSheet(&quot;wronginput&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>Return<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>ws.Session.SetAttribute(&quot;IsAuthorized&quot;,
&quot;true&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>ABMShared.NavigateToPage(ws, &quot;&quot;,
&quot;./&quot; &amp; InitialPage)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>Sub
BuildLoginSheet() As ABMModalSheet<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Dim myModal As ABMModalSheet<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>myModal.Initialize(AppPage,
&quot;login&quot;, False, False, &quot;&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>myModal.Content.UseTheme(&quot;modalcontent&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>myModal.Footer.UseTheme(&quot;modalfooter&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>myModal.IsDismissible = False<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' create the grid for the content<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>myModal.Content.AddRows(2,True,
&quot;&quot;).AddCells12(1,&quot;&quot;)<span style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>myModal.Content.BuildGrid 'IMPORTANT once you
loaded the complete grid AND before you start adding components<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' add paragraph<span style='mso-tab-count:
1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>myModal.Content.Cell(1,1).AddComponent(ABMShared.BuildParagraph(AppPage,&quot;par1&quot;,&quot;Please
login: (login and password are 'demo')&quot;) )<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' create the input fields for the content<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Dim inp1 As ABMInput<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>inp1.Initialize(AppPage, &quot;inp1&quot;,
ABM.INPUT_TEXT, &quot;Login&quot;, False, &quot;&quot;)<span style='mso-tab-count:
1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>myModal.Content.Cell(2,1).AddComponent(inp1)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Dim inp2 As ABMInput<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>inp2.Initialize(AppPage, &quot;inp2&quot;,
ABM.INPUT_TEXT, &quot;Password&quot;, False, &quot;&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>myModal.Content.Cell(2,1).AddComponent(inp2)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' create the grid for the footer<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' we add a row without the default 20px
padding so we need to use AddRowsM().<span style='mso-spacerun:yes'> </span>If
we do not use this method, a scrollbar will appear to the sheet.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>myModal.Footer.AddRowsM(1,True,0,0,
&quot;&quot;).AddCellsOS(1,9,9,9,3,3,3, &quot;&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>myModal.Footer.BuildGrid 'IMPORTANT once you
loaded the complete grid AND before you start adding components<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' create the button for the footer<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Dim msbtn1 As ABMButton<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>msbtn1.InitializeFlat(AppPage,
&quot;msbtn1&quot;, &quot;&quot;, &quot;&quot;, &quot;Login&quot;,
&quot;transparent&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>myModal.Footer.Cell(1,1).AddComponent(msbtn1)<span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Return myModal<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>Sub
BuildWrongInputModalSheet() As ABMModalSheet<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Dim myModalError As ABMModalSheet<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>myModalError.Initialize(AppPage,
&quot;wronginput&quot;, False, False, &quot;&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>myModalError.Content.UseTheme(&quot;modalcontent&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>myModalError.Footer.UseTheme(&quot;modalcontent&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>myModalError.IsDismissible = True<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' create the grid for the content<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>myModalError.Content.AddRows(1,True,
&quot;&quot;).AddCells12(1,&quot;&quot;)<span style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>myModalError.Content.BuildGrid 'IMPORTANT
once you loaded the complete grid AND before you start adding components<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Dim lbl1 As ABMLabel<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>lbl1.Initialize(AppPage,
&quot;contlbl1&quot;, &quot;The login or password are
incorrect!&quot;,ABM.SIZE_PARAGRAPH, False, &quot;&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>myModalError.Content.Cell(1,1).AddComponent(lbl1)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Return myModalError<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>'
clicked on the navigation bar<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>Sub
Page_NavigationbarClicked(Action As String, Value As String)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>AppPage.SaveNavigationBarPosition<span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'></span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-bidi-font-family:"Courier New";mso-ansi-language:EN-US'>NOTE:
At the end, do a search for Page_Ready, as I sometimes forgot that part too to
remove this code while upgrading!<o:p></o:p></span></b></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><br clear=all style='mso-special-character:
line-break;page-break-before:always'>
</span><span lang=EN-US style='font-size:16.0pt;line-height:107%;font-family:
"Calibri Light","sans-serif";mso-ascii-theme-font:major-latin;mso-fareast-font-family:
"Times New Roman";mso-fareast-theme-font:major-fareast;mso-hansi-theme-font:
major-latin;mso-bidi-font-family:"Times New Roman";mso-bidi-theme-font:major-bidi;
color:#2E74B5;mso-themecolor:accent1;mso-themeshade:191;mso-ansi-language:EN-US'><o:p></o:p></span></p>

<h1 style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l2 level1 lfo1'><![if !supportLists]><span
lang=EN-US style='mso-fareast-font-family:"Calibri Light";mso-fareast-theme-font:
major-latin;mso-bidi-font-family:"Calibri Light";mso-bidi-theme-font:major-latin;
mso-ansi-language:EN-US'><span style='mso-list:Ignore'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
lang=EN-US style='mso-ansi-language:EN-US'>For each of your own pages.<o:p></o:p></span></h1>

<h2 style='margin-left:40.5pt;text-indent:-22.5pt;mso-list:l2 level2 lfo1'><![if !supportLists]><span
lang=EN-US style='mso-fareast-font-family:"Calibri Light";mso-fareast-theme-font:
major-latin;mso-bidi-font-family:"Calibri Light";mso-bidi-theme-font:major-latin;
mso-ansi-language:EN-US'><span style='mso-list:Ignore'>3.1.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span></span><![endif]><span
lang=EN-US style='mso-ansi-language:EN-US'>The classic ABMaterial way using
BuildPage() and ConnectPage()<o:p></o:p></span></h2>

<p class=MsoNormal style='margin-left:18.0pt'><span lang=EN-US
style='mso-ansi-language:EN-US'>The Page_Ready event does not exist any more
(and will never be raised!).<span style='mso-spacerun:yes'> </span>Instead
move this code (without the call to connectPage() else we loop), at the end of
your Connect_Page() method.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>'Class
module<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>Sub
Class_Globals<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Private ws As WebSocket 'ignore<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' will hold our page information<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Public page As ABMPage<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' page theme<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Private theme As ABMTheme<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' to access the constants<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Private ABM As ABMaterial 'ignore<span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' name of the page, must be the same as the
class name (case sensitive!)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Public Name As String =
&quot;ABMPageTemplate&quot;<span style='mso-spacerun:yes'>
</span>'&lt;-------------------------------------------------------- IMPORTANT<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' will hold the unique browsers window id<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><span style='color:red'>Private ABMPageId As
String = &quot;&quot;<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' your own variables<span style='mso-tab-count:
2'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:
EN-US'>This is needed for ABMApplication to write the initial HTML/JavaScript
and CSS files.</span><span lang=EN-US style='font-size:8.0pt;line-height:107%;
font-family:"Courier New";mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>'Initializes
the object. You can add parameters to this method if needed.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>Public
Sub Initialize<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' build the local structure IMPORTANT!<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><span style='color:red'>BuildPage</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='mso-bidi-font-family:
"Courier New";mso-ansi-language:EN-US'>At this point the initial page (what you
have done in the BuildPage() has been loaded in the browser.<span
style='mso-spacerun:yes'> </span>Before 2.17, a second event called Page_Ready
was needed, but this was not a very reliable way.<span
style='mso-spacerun:yes'> </span><b style='mso-bidi-font-weight:normal'>So now
when WebSocket_Connected() called, we know we have a html file and all
javascript libraries are loaded.</b><span style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='mso-bidi-font-family:
"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-ansi-language:EN-US'>In essence, this is ALL you do in
WebSocket_Connected!</span></b><span lang=EN-US style='mso-ansi-language:EN-US'><span
style='mso-spacerun:yes'> </span><b style='mso-bidi-font-weight:normal'>NO
additional SetWebSockets, Page.Prepares or Page.Refreshes here</b>.<span
style='mso-spacerun:yes'> </span>They have all been handled.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='mso-ansi-language:
EN-US'>ALSO: Do <b style='mso-bidi-font-weight:normal'>NOT</b> add
ABMComponents to your page here.<span style='mso-spacerun:yes'> </span>Use
ConnectPage for that (see further). The only thing you do here is things like
Initializing timers, setting/getting other session variables, getting setting
variables from the local storage.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>Private
Sub WebSocket_Connected (WebSocket1 As WebSocket)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Log(&quot;Connected&quot;)<span
style='mso-tab-count:2'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><span style='color:red'>ws = WebSocket1<span
style='mso-tab-count:1'> </span><o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>ABMPageId = ABM.GetPageID(page,
Name,ws)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>Dim session As HttpSession =
ABM.GetSession(ws, ABMShared.SessionMaxInactiveIntervalSeconds)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>If ABMShared.NeedsAuthorization Then<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>If
session.GetAttribute2(&quot;IsAuthorized&quot;, &quot;&quot;) = &quot;&quot;
Then<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span>ABMShared.NavigateToPage(ws,
ABMPageId, &quot;../&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span>Return<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><span style='color:red'>ABM.UpdateFromCache(Me,
ABMShared.CachedPages, ABMPageId, ws)<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>If page.ComesFromPageCache Then<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>' refresh the page<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>page.Refresh<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>' Tell the browser we
finished loading<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>page.FinishedLoading<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>Else<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>' Prepare the page <o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>page.Prepare<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>' load the dynamic
content<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>ConnectPage<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>Log(ABMPageId)<span
style='mso-tab-count:1'> </span></span><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-ansi-language:EN-US'>WebSocket_Disconnected()</span></b><span
lang=EN-US style='mso-ansi-language:EN-US'> is a good place to stop your
timers.</span><span lang=EN-US style='font-size:8.0pt;line-height:107%;
font-family:"Courier New";mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>Private
Sub WebSocket_Disconnected<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Log(&quot;Disconnected&quot;)<span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
18.0pt'><span lang=EN-US style='mso-ansi-language:EN-US'>In ABMaterial 216+, a
new special event <b style='mso-bidi-font-weight:normal'>beforeunload</b> is
called.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;text-indent:
18.0pt'><span lang=EN-US style='mso-ansi-language:EN-US'>There is no need to
add/change anything in Page_ParseEvent.<span style='mso-spacerun:yes'>
</span>Leave it as described below.</span><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>Sub
Page_ParseEvent(Params As Map) <o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Dim eventName As String =
Params.Get(&quot;eventname&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Dim eventParams() As String =
Regex.Split(&quot;,&quot;,Params.Get(&quot;eventparams&quot;))<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><span style='color:red'>If eventName =
&quot;beforeunload&quot; Then<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>Log(&quot;preparing for
url refresh&quot;)<span style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>ABM.RemoveMeFromCache(ABMShared.CachedPages,
ABMPageId)<span style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>Return<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>If SubExists(Me, eventName) Then<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>Params.Remove(&quot;eventname&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>Params.Remove(&quot;eventparams&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>Select Case Params.Size<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span>Case 0<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:4'> </span>CallSub(Me, eventName)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span>Case 1<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:4'> </span>CallSub2(Me, eventName,
Params.Get(eventParams(0)))<span style='mso-tab-count:4'> </span><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span>Case 2<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:4'> </span>If
Params.get(eventParams(0)) = &quot;abmistable&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:5'> </span>Dim PassedTables
As List = ABM.ProcessTablesFromTargetName(Params.get(eventParams(1)))<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:5'> </span>CallSub2(Me,
eventName, PassedTables)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:4'> </span>Else<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:5'> </span>CallSub3(Me,
eventName, Params.Get(eventParams(0)), Params.Get(eventParams(1)))<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:4'> </span>End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span>Case Else<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span><span style='mso-tab-count:
1'> </span>' cannot be called directly, to many param<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:4'> </span>CallSub2(Me, eventName,
Params)<span style='mso-tab-count:4'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>End Select<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:18.0pt'><span lang=EN-US
style='mso-ansi-language:EN-US'>Always load the base theme from ABMShared.<span
style='mso-spacerun:yes'> </span>You can add extra page specific themes to
it.<span style='mso-spacerun:yes'> </span>This is called when the server is
started, and is <b style='mso-bidi-font-weight:normal'>the only place in the
page where themes can be defined</b>!</span><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>public
Sub BuildTheme()<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' start with the base theme defined in
ABMShared<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>theme.Initialize(&quot;pagetheme&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>theme.AddABMTheme(ABMShared.MyTheme)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' add additional themes specific for this
page<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:18.0pt'><span lang=EN-US
style='mso-ansi-language:EN-US'>Here we build the initial STRUCTURE of the
page.<span style='mso-spacerun:yes'> </span>We can set some page properties
and we have to build our GRID.<span style='mso-spacerun:yes'> </span>You add
ABMcomponents here, but it is <b style='mso-bidi-font-weight:normal'>not
advisable</b>!<span style='mso-spacerun:yes'> </span>Components defined here
are static.<span style='mso-spacerun:yes'> </span>If you want dynamic
components, it is better to define them in ConnectPage.<span
style='mso-spacerun:yes'> </span>We can also add the ModalSheets here.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:18.0pt'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-ansi-language:EN-US'>NOTE: the page
Initialize methods have a new PARAMETER:</span></b><span lang=EN-US
style='mso-ansi-language:EN-US'> </span><span lang=EN-US style='font-size:8.0pt;
line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:EN-US'>ABMShared.SessionMaxInactiveIntervalSeconds</span><span
lang=EN-US style='font-size:8.0pt;line-height:107%;font-family:"Courier New";
mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>public
Sub BuildPage()<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' initialize the theme<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>BuildTheme<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' initialize this page using our theme<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>page.InitializeWithTheme(Name,
&quot;/ws/&quot; &amp; ABMShared.AppName &amp; &quot;/&quot; &amp; Name, False,
ABMShared.SessionMaxInactiveIntervalSeconds, theme)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>page.ShowLoader=True<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>page.PageHTMLName = &quot;index.html&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>page.PageTitle = &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>page.PageDescription = &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>page.PageKeywords = &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>page.PageSiteMapPriority = &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>page.PageSiteMapFrequency =
ABM.SITEMAP_FREQ_YEARLY<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>page.ShowConnectedIndicator = True<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' adding a navigation bar<span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' create the page grid<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>page.AddRows(2,True,
&quot;&quot;).AddCells12(1,&quot;&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>page.BuildGrid 'IMPORTANT once you loaded the
complete grid AND before you start adding components<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:18.0pt'><span lang=EN-US
style='mso-ansi-language:EN-US'>Here we define all our components! Note that
any definition of a component you make here, is purely <b style='mso-bidi-font-weight:
normal'>a mirror object</b> of what will be seen in the users browser.<span
style='mso-spacerun:yes'> </span>This is the reason we do not put dims om
ABMComponents in Global_Class as if you do, they are not synced with the
users browser.<span style='mso-spacerun:yes'> </span>Only when you use a
method like Page.Component(), the sync happens between the browser and the
server. (e.g. in an ABMInput component, the servers object will receive the
actual Text value the users entered in the browser).<span
style='mso-spacerun:yes'> </span>It is using the JQueryElement and Future
mechanism forseen by B4J. <o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:18.0pt'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-ansi-language:EN-US'>As Page_Ready() is
depreciated, we also have to add its code to the ConnectPage method!</span></b><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='font-size:8.0pt;
line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>public
Sub ConnectPage()<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>'<span
style='mso-tab-count:1'> </span>connecting the navigation bar<span
style='mso-tab-count:2'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>'<span
style='mso-tab-count:1'> </span>init all your own variables (like a List, Map)
and add your components<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>'<span
style='mso-tab-count:1'> </span>page.Cell(1,1).AddComponent(ABMShared.BuildParagraph(page,
&quot;lbl&quot;, &quot;This is a test&quot;))<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>'<span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>'<span
style='mso-tab-count:1'> </span>Dim btn As ABMButton<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>'<span
style='mso-tab-count:1'> </span>btn.InitializeRaised(page, &quot;btn&quot;,
&quot;&quot;, &quot;&quot;, &quot;Press me&quot;, &quot;&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>'<span
style='mso-tab-count:1'> </span>page.Cell(2,1).AddComponent(btn)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><span style='color:red'>' refresh the page<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>page.Refresh<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>' Tell the browser we finished
loading<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>page.FinishedLoading<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>' restoring the navigation bar
position<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>page.RestoreNavigationBarPosition
'used to be in the depreciated Page_Ready() event!<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='mso-bidi-font-family:
"Courier New";mso-ansi-language:EN-US'>Method to handle the navigation through
the app from page to page<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>'
clicked on the navigation bar<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>Sub
Page_NavigationbarClicked(Action As String, Value As String)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' saving the navigation bar position<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>page.SaveNavigationBarPosition<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>If Action = &quot;LogOff&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>ABMShared.LogOff(page)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>Return<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>ABMShared.NavigateToPage(ws, ABMPageId,
Value)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:18.0pt'><span lang=EN-US
style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-bidi-font-family:"Courier New";mso-ansi-language:EN-US'>NOTE:
At the end, do a search for Page_Ready, as I sometimes forgot that part too to
remove this code while upgrading!<o:p></o:p></span></b></p>

<span lang=EN-US style='font-size:11.0pt;line-height:107%;font-family:"Calibri","sans-serif";
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:Calibri;mso-fareast-theme-font:
minor-latin;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:"Times New Roman";
mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US;mso-fareast-language:
EN-US;mso-bidi-language:AR-SA'><br clear=all style='mso-special-character:line-break;
page-break-before:always'>
</span>

<p class=MsoNormal style='margin-left:18.0pt'><span lang=EN-US
style='mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<h2 style='margin-left:40.5pt;text-indent:-22.5pt;mso-list:l2 level2 lfo1'><![if !supportLists]><span
lang=EN-US style='mso-fareast-font-family:"Calibri Light";mso-fareast-theme-font:
major-latin;mso-bidi-font-family:"Calibri Light";mso-bidi-theme-font:major-latin;
mso-ansi-language:EN-US'><span style='mso-list:Ignore'>3.2.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span></span><![endif]><span
lang=EN-US style='mso-ansi-language:EN-US'>The alternative: ABMaterial without
using BuildPage() and ConnectPage(), more classic B4J style<o:p></o:p></span></h2>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>'Class
module<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>Sub
Class_Globals<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Private ws As WebSocket 'ignore<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' will hold our page information<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Public page As ABMPage<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' page theme<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Private theme As ABMTheme<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' to access the constants<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Private ABM As ABMaterial 'ignore<span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' name of the page, must be the same as the
class name (case sensitive!)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Public Name As String =
&quot;ABMPageTemplateAlternative&quot;<span style='mso-spacerun:yes'>
</span>'&lt;-------------------------------------------------------- IMPORTANT<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' will hold the unique browsers window id<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><span style='color:red'>Private ABMPageId As
String = &quot;&quot;</span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:18.0pt'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='mso-ansi-language:EN-US'>NOTE: the page
Initialize methods have a new PARAMETER:</span></b><span lang=EN-US
style='mso-ansi-language:EN-US'> </span><span lang=EN-US style='font-size:8.0pt;
line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:EN-US'>ABMShared.SessionMaxInactiveIntervalSeconds</span><span
lang=EN-US style='font-size:8.0pt;line-height:107%;font-family:"Courier New";
mso-ansi-language:EN-US'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>'Initializes
the object. You can add parameters to this method if needed.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>Public
Sub Initialize<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' build the local structure IMPORTANT!<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' start with the base theme defined in
ABMShared<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>theme.Initialize(&quot;pagetheme&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>theme.AddABMTheme(ABMShared.MyTheme)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' add additional themes specific for this
page<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' initialize this page using our theme<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>page.InitializeWithTheme(Name,
&quot;/ws/&quot; &amp; ABMShared.AppName &amp; &quot;/&quot; &amp; Name, False,
ABMShared.SessionMaxInactiveIntervalSeconds, theme)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>page.ShowLoader=True<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>page.PageHTMLName = &quot;index.html&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>page.PageTitle = &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>page.PageDescription = &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>page.PageKeywords = &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>page.PageSiteMapPriority = &quot;&quot;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>page.PageSiteMapFrequency =
ABM.SITEMAP_FREQ_YEARLY<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>page.ShowConnectedIndicator = True<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' adding a navigation bar<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' create the page grid<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>page.AddRows(2,True,
&quot;&quot;).AddCells12(1,&quot;&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>page.BuildGrid 'IMPORTANT once you loaded the
complete grid AND before you start adding components<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<span lang=EN-US style='font-size:8.0pt;line-height:107%;font-family:"Courier New";
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-ansi-language:
EN-US;mso-fareast-language:EN-US;mso-bidi-language:AR-SA'><br clear=all
style='mso-special-character:line-break;page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-US style='font-size:8.0pt;line-height:107%;
font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>Private
Sub WebSocket_Connected (WebSocket1 As WebSocket)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Log(&quot;Connected&quot;)<span
style='mso-tab-count:2'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><span style='color:red'>ws = WebSocket1<span
style='mso-tab-count:1'> </span><o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>ABMPageId = ABM.GetPageID(page,
Name,ws)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>Dim session As HttpSession =
ABM.GetSession(ws, ABMShared.SessionMaxInactiveIntervalSeconds)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>If ABMShared.NeedsAuthorization Then<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>If session.GetAttribute2(&quot;IsAuthorized&quot;,
&quot;&quot;) = &quot;&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span>ABMShared.NavigateToPage(ws,
ABMPageId, &quot;../&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span>Return<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><span style='color:red'>ABM.UpdateFromCache(Me,
ABMShared.CachedPages, ABMPageId, ws)<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>If page.ComesFromPageCache Then<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>' refresh the page<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>page.Refresh<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>' Tell the browser we
finished loading<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>page.FinishedLoading<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>Else<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>' Prepare the page <o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>page.Prepare<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span></span><span lang=EN-US
style='font-size:8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:
EN-US'>' load the dynamic content<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>' connecting the navigation bar<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>' init all your own variables (like a
List, Map) and add your components<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>'<span style='mso-tab-count:1'> </span>page.Cell(1,1).AddComponent(ABMShared.BuildParagraph(page,
&quot;lbl&quot;, &quot;This is a test&quot;))<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>'<span style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>'<span style='mso-tab-count:1'> </span>Dim
btn As ABMButton<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>'<span style='mso-tab-count:1'> </span>btn.InitializeRaised(page,
&quot;btn&quot;, &quot;&quot;, &quot;&quot;, &quot;Press me&quot;,
&quot;&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>'<span style='mso-tab-count:1'> </span>page.Cell(2,1).AddComponent(btn)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>' refresh the page<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>page.Refresh<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>' Tell the browser we
finished loading<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>page.FinishedLoading<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>' restoring the
navigation bar position<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>page.RestoreNavigationBarPosition
'used to be in the depreciated Page_Ready() event!<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>Log(ABMPageId)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>Private
Sub WebSocket_Disconnected<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Log(&quot;Disconnected&quot;)<span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<span lang=EN-US style='font-size:8.0pt;line-height:107%;font-family:"Courier New";
mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-ansi-language:
EN-US;mso-fareast-language:EN-US;mso-bidi-language:AR-SA'><br clear=all
style='mso-special-character:line-break;page-break-before:always'>
</span>

<p class=MsoNormal style='margin-left:18.0pt'><span lang=EN-US
style='font-size:8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:
EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>Sub
Page_ParseEvent(Params As Map) <o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Dim eventName As String =
Params.Get(&quot;eventname&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>Dim eventParams() As String =
Regex.Split(&quot;,&quot;,Params.Get(&quot;eventparams&quot;))<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span><span style='color:red'>If eventName =
&quot;beforeunload&quot; Then<o:p></o:p></span></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>Log(&quot;preparing for
url refresh&quot;)<span style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>ABM.RemoveMeFromCache(ABMShared.CachedPages,
ABMPageId)<span style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:2'> </span>Return<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";color:red;mso-ansi-language:
EN-US'><span style='mso-tab-count:1'> </span>End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>If SubExists(Me, eventName) Then<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>Params.Remove(&quot;eventname&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>Params.Remove(&quot;eventparams&quot;)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>Select Case Params.Size<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span>Case 0<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:4'> </span>CallSub(Me, eventName)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span>Case 1<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:4'> </span>CallSub2(Me, eventName,
Params.Get(eventParams(0)))<span style='mso-tab-count:4'> </span><span
style='mso-tab-count:1'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span>Case 2<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:4'> </span>If
Params.get(eventParams(0)) = &quot;abmistable&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:5'> </span>Dim PassedTables
As List = ABM.ProcessTablesFromTargetName(Params.get(eventParams(1)))<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:5'> </span>CallSub2(Me, eventName,
PassedTables)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:4'> </span>Else<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:5'> </span>CallSub3(Me,
eventName, Params.Get(eventParams(0)), Params.Get(eventParams(1)))<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:4'> </span>End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:3'> </span>Case Else<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:4'> </span>' cannot be called
directly, to many param<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:4'> </span>CallSub2(Me, eventName,
Params)<span style='mso-tab-count:4'> </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>End Select<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>'
clicked on the navigation bar<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>Sub
Page_NavigationbarClicked(Action As String, Value As String)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>' saving the navigation bar position<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>page.SaveNavigationBarPosition<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>If Action = &quot;LogOff&quot; Then<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>ABMShared.LogOff(page)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:2'> </span>Return<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>End If<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'><span
style='mso-tab-count:1'> </span>ABMShared.NavigateToPage(ws, ABMPageId,
Value)<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><span lang=EN-US style='font-size:
8.0pt;line-height:107%;font-family:"Courier New";mso-ansi-language:EN-US'>End
Sub<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt'><span
lang=EN-US style='font-size:8.0pt;line-height:107%;font-family:"Courier New";
mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt'><span
lang=EN-US style='font-size:8.0pt;line-height:107%;font-family:"Courier New";
mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-bidi-font-family:"Courier New";mso-ansi-language:EN-US'>NOTE:
At the end, do a search for Page_Ready, as I sometimes forgot that part too to
remove this code while upgrading!<o:p></o:p></span></b></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:18.0pt;margin-bottom:.0001pt'><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='mso-bidi-font-family:"Courier New";mso-ansi-language:EN-US'><o:p>&nbsp;</o:p></span></b></p>

</div>

</body>

</html>
